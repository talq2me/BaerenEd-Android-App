<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Battle Hub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard', 'Arial Rounded MT Bold', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .pokedex-section {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border: 5px solid #ffd700;
        }

        .section-title {
            font-size: 2em;
            color: #764ba2;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .pokemon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .pokemon-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .pokemon-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .pokemon-card.selected {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
            50% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.9); }
        }

        .pokemon-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
            filter: grayscale(100%);
        }

        .pokemon-sprite {
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }

        .pokemon-sprite img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .pokemon-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .pokemon-level {
            font-size: 0.9em;
            color: #666;
        }

        .battle-arena {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border: 5px solid #ff6b6b;
        }

        .battle-instructions {
            text-align: center;
            font-size: 1.3em;
            color: #764ba2;
            margin-bottom: 30px;
            padding: 15px;
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-radius: 15px;
            font-weight: bold;
        }

        .battle-field {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
            margin: 30px 0;
            min-height: 300px;
        }

        .pokemon-battle-card {
            text-align: center;
            flex: 1;
            min-width: 250px;
        }

        .pokemon-battle-sprite {
            width: 200px;
            height: 200px;
            margin: 0 auto 20px;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            filter: drop-shadow(5px 5px 10px rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
        }

        .pokemon-battle-sprite img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .pokemon-battle-name {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .pokemon-battle-stats {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
        }

        .stat-bar {
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .stat-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71 0%, #27ae60 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
        }

        .vs-divider {
            font-size: 3em;
            color: #ff6b6b;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .berry-section {
            background: white;
            border-radius: 25px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border: 5px solid #2ecc71;
        }

        .berry-meter-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .berry-meter-label {
            font-size: 1.5em;
            color: #764ba2;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .berry-meter {
            width: 100%;
            height: 60px;
            background: #e0e0e0;
            border-radius: 30px;
            overflow: hidden;
            position: relative;
            border: 4px solid #2ecc71;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.2);
        }

        .berry-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b 0%, #ee5a6f 50%, #ffd700 100%);
            border-radius: 30px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .berry-fill::before {
            content: 'üçì';
            position: absolute;
            left: 10px;
            font-size: 1.5em;
            animation: berryBounce 1s infinite;
        }

        .berry-fill::after {
            content: 'üçì';
            position: absolute;
            right: 10px;
            font-size: 1.5em;
            animation: berryBounce 1.2s infinite;
        }

        @keyframes berryBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .berry-fill.full {
            animation: glow 1s infinite alternate;
        }

        @keyframes glow {
            0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
            100% { box-shadow: 0 0 40px rgba(255, 215, 0, 1); }
        }

        .berry-count {
            position: absolute;
            width: 100%;
            text-align: center;
            z-index: 1;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .action-button {
            padding: 20px 40px;
            font-size: 1.5em;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-family: 'Comic Sans MS', 'Chalkboard', 'Arial Rounded MT Bold', sans-serif;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .action-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .action-button:hover::before {
            width: 300px;
            height: 300px;
        }

        .action-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .action-button:active {
            transform: translateY(0) scale(0.98);
        }

        .berry-button {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .battle-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }

        .battle-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .battle-button:disabled:hover {
            transform: none;
        }

        .educational-games-list {
            background: rgba(255,255,255,0.9);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .game-item {
            padding: 10px;
            margin: 5px 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .game-item:hover {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            transform: translateX(5px);
        }

        .victory-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .victory-content {
            background: white;
            border-radius: 25px;
            padding: 50px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: victoryPop 0.5s ease;
        }

        @keyframes victoryPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .victory-content h2 {
            font-size: 3em;
            color: #2ecc71;
            margin-bottom: 20px;
        }

        .victory-content .pokemon-sprite {
            width: 150px;
            height: 150px;
            margin: 20px auto;
        }

        .victory-button {
            margin-top: 20px;
            padding: 15px 30px;
            font-size: 1.3em;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .pokemon-battle-sprite {
                font-size: 5em;
            }

            .battle-field {
                flex-direction: column;
            }

            .vs-divider {
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° Pokemon Battle Hub ‚ö°</h1>
            <p style="font-size: 1.3em;">Power up your Pokemon and catch them all!</p>
        </div>

        <!-- Pokedex Section -->
        <div class="pokedex-section">
            <h2 class="section-title">üìñ My Pokedex</h2>
            <div class="pokemon-grid" id="pokedexGrid">
                <!-- Pokemon cards will be generated here -->
            </div>
        </div>

        <!-- Battle Arena -->
        <div class="battle-arena">
            <div class="battle-instructions">
                üí™ Power up your Pokemon with berries before battling the boss! üí™
            </div>
            
            <div class="battle-field">
                <div class="pokemon-battle-card">
                    <div class="pokemon-battle-sprite" id="playerPokemonSprite">üêâ</div>
                    <div class="pokemon-battle-name" id="playerPokemonName">Dragonite</div>
                    <div class="pokemon-battle-stats">
                        <div class="stat-bar">
                            <div class="stat-label">HP</div>
                            <div class="stat-value">
                                <div class="stat-fill" id="playerHP" style="width: 100%;">100/100</div>
                            </div>
                        </div>
                        <div class="stat-bar">
                            <div class="stat-label">Power</div>
                            <div class="stat-value">
                                <div class="stat-fill" id="playerPower" style="width: 0%;">0%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="vs-divider">VS</div>

                <div class="pokemon-battle-card">
                    <div class="pokemon-battle-sprite" id="bossPokemonSprite">üî•</div>
                    <div class="pokemon-battle-name" id="bossPokemonName">Charizard</div>
                    <div class="pokemon-battle-stats">
                        <div class="stat-bar">
                            <div class="stat-label">HP</div>
                            <div class="stat-value">
                                <div class="stat-fill" style="width: 100%; background: linear-gradient(90deg, #ff6b6b 0%, #ee5a6f 100%);">100/100</div>
                            </div>
                        </div>
                        <div class="stat-bar">
                            <div class="stat-label">Power</div>
                            <div class="stat-value">
                                <div class="stat-fill" style="width: 100%; background: linear-gradient(90deg, #ff6b6b 0%, #ee5a6f 100%);">100%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Berry Section -->
        <div class="berry-section">
            <div class="berry-meter-container">
                <div class="berry-meter-label">üçì Berry Power Meter üçì</div>
                <div class="berry-meter">
                    <div class="berry-fill" id="berryFill" style="width: 0%;">
                        <div class="berry-count" id="berryCount">0 / 100 Berries</div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-button berry-button" id="berryButton">
                    üçì Earn Berries üçì
                </button>
                <button class="action-button battle-button" id="battleButton" disabled>
                    ‚öîÔ∏è Battle Boss ‚öîÔ∏è
                </button>
            </div>

            <div class="educational-games-list" id="gamesList" style="display: none;">
                <h3 style="margin-bottom: 15px; color: #764ba2;">Choose a game to earn berries:</h3>
                <div id="gamesContainer"></div>
            </div>
        </div>
    </div>

    <!-- Victory Overlay -->
    <div class="victory-overlay" id="victoryOverlay">
        <div class="victory-content">
            <h2>üéâ Victory! üéâ</h2>
            <div class="pokemon-sprite" id="victoryPokemonSprite">üî•</div>
            <p style="font-size: 1.5em; margin: 20px 0;">
                You caught <span id="victoryPokemonName">Charizard</span>!
            </p>
            <p style="font-size: 1.2em; color: #666;">
                Added to your Pokedex!
            </p>
            <button class="victory-button" onclick="closeVictory()">Continue</button>
        </div>
    </div>

    <script>
        // Pokemon data with actual Pokemon IDs
        const pokemonList = [
            { id: 1, pokemonId: 25, name: 'Pikachu', level: 5, spriteFile: '25-475-mega-s.png' },
            { id: 2, pokemonId: 6, name: 'Charizard', level: 10, spriteFile: '6-869.png' },
            { id: 3, pokemonId: 9, name: 'Blastoise', level: 15, spriteFile: '9-327-s.png' },
            { id: 4, pokemonId: 3, name: 'Venusaur', level: 20, spriteFile: '3-1000.png' },
            { id: 5, pokemonId: 149, name: 'Dragonite', level: 25, spriteFile: '149-279.png' },
            { id: 6, pokemonId: 150, name: 'Mewtwo', level: 30, spriteFile: '150-10000.png' },
            { id: 7, pokemonId: 130, name: 'Gyarados', level: 35, spriteFile: '130-10000.png' },
            { id: 8, pokemonId: 143, name: 'Snorlax', level: 40, spriteFile: '143-10000.png' }
        ];

        // Helper function to get sprite path
        function getSpritePath(pokemon) {
            const basePath = 'file:///android_asset/images/pokeSprites/sprites/pokemon/';
            // Try to find a sprite file, preferring ones starting with 1 or 2
            // For now, use the specified spriteFile or try common patterns
            if (pokemon.spriteFile) {
                return basePath + pokemon.spriteFile;
            }
            // Fallback: try common patterns
            const patterns = [
                `${pokemon.pokemonId}-1.png`,
                `${pokemon.pokemonId}-2.png`,
                `${pokemon.pokemonId}-10000.png`,
                `${pokemon.pokemonId}-*.png`
            ];
            return basePath + patterns[0]; // Use first pattern as default
        }

        // Game state
        let gameState = {
            unlockedPokemon: [1], // Start with first Pokemon
            selectedPokemon: 1,
            currentBoss: 2,
            berries: 0,
            maxBerries: 100,
            requiredGames: [
                { title: 'Google Read Along', launch: 'googleReadAlong', berries: 20 },
                { title: 'Duological', launch: 'duologicalGame', berries: 20 },
                { title: 'Translation', launch: 'translation', berries: 20 },
                { title: 'French Stories', launch: 'frenchStories', berries: 20 },
                { title: 'Times Tables', launch: 'timesTables', berries: 20 }
            ],
            optionalGames: [
                { title: 'Word Garden', launch: 'wordGarden', berries: 10 },
                { title: 'Potion Maker', launch: 'potionMaker', berries: 10 },
                { title: 'Spelling Race', launch: 'spellingRace', berries: 10 }
            ]
        };

        // Load saved state from localStorage
        function loadState() {
            const saved = localStorage.getItem('pokemonBattleState');
            if (saved) {
                gameState = { ...gameState, ...JSON.parse(saved) };
            }
        }

        // Save state to localStorage
        function saveState() {
            localStorage.setItem('pokemonBattleState', JSON.stringify(gameState));
        }

        // Initialize
        function init() {
            loadState();
            renderPokedex();
            updateBattleArena();
            updateBerryMeter();
            updateBattleButton();
        }

        // Render Pokedex
        function renderPokedex() {
            const grid = document.getElementById('pokedexGrid');
            grid.innerHTML = '';

            pokemonList.forEach(pokemon => {
                const isUnlocked = gameState.unlockedPokemon.includes(pokemon.id);
                const isSelected = gameState.selectedPokemon === pokemon.id;
                
                const card = document.createElement('div');
                card.className = `pokemon-card ${isUnlocked ? '' : 'locked'} ${isSelected ? 'selected' : ''}`;
                const spritePath = getSpritePath(pokemon);
                card.innerHTML = `
                    <div class="pokemon-sprite">
                        <img src="${spritePath}" alt="${pokemon.name}" onerror="this.style.display='none'; this.parentElement.innerHTML='‚ùì';">
                    </div>
                    <div class="pokemon-name">${pokemon.name}</div>
                    <div class="pokemon-level">Level ${pokemon.level}</div>
                `;
                
                if (isUnlocked) {
                    card.onclick = () => selectPokemon(pokemon.id);
                }
                
                grid.appendChild(card);
            });
        }

        // Select Pokemon
        function selectPokemon(id) {
            gameState.selectedPokemon = id;
            saveState();
            renderPokedex();
            updateBattleArena();
        }

        // Update Battle Arena
        function updateBattleArena() {
            const playerPokemon = pokemonList.find(p => p.id === gameState.selectedPokemon);
            const bossPokemon = pokemonList.find(p => p.id === gameState.currentBoss);

            const playerSprite = document.getElementById('playerPokemonSprite');
            const bossSprite = document.getElementById('bossPokemonSprite');
            
            playerSprite.innerHTML = `<img src="${getSpritePath(playerPokemon)}" alt="${playerPokemon.name}" onerror="this.parentElement.textContent='‚ùì';">`;
            document.getElementById('playerPokemonName').textContent = playerPokemon.name;
            
            bossSprite.innerHTML = `<img src="${getSpritePath(bossPokemon)}" alt="${bossPokemon.name}" onerror="this.parentElement.textContent='‚ùì';">`;
            document.getElementById('bossPokemonName').textContent = bossPokemon.name;

            // Update player power based on berries
            const powerPercent = (gameState.berries / gameState.maxBerries) * 100;
            const powerFill = document.getElementById('playerPower');
            powerFill.style.width = powerPercent + '%';
            powerFill.textContent = Math.round(powerPercent) + '%';
        }

        // Update Berry Meter
        function updateBerryMeter() {
            const percent = (gameState.berries / gameState.maxBerries) * 100;
            const fill = document.getElementById('berryFill');
            const count = document.getElementById('berryCount');

            fill.style.width = percent + '%';
            count.textContent = `${gameState.berries} / ${gameState.maxBerries} Berries`;

            if (percent >= 100) {
                fill.classList.add('full');
            } else {
                fill.classList.remove('full');
            }
        }

        // Update Battle Button
        function updateBattleButton() {
            const button = document.getElementById('battleButton');
            const isFull = gameState.berries >= gameState.maxBerries;
            button.disabled = !isFull;
            
            if (isFull) {
                button.style.animation = 'glow 1s infinite alternate';
            } else {
                button.style.animation = 'none';
            }
        }

        // Show Games List
        function showGamesList() {
            const list = document.getElementById('gamesList');
            const container = document.getElementById('gamesContainer');
            
            container.innerHTML = '';
            
            // Add required games
            const requiredTitle = document.createElement('h4');
            requiredTitle.textContent = 'Required Tasks:';
            requiredTitle.style.color = '#e74c3c';
            requiredTitle.style.marginTop = '10px';
            container.appendChild(requiredTitle);
            
            gameState.requiredGames.forEach(game => {
                const item = document.createElement('div');
                item.className = 'game-item';
                item.innerHTML = `üéÆ ${game.title} (+${game.berries} berries)`;
                item.onclick = () => launchGame(game);
                container.appendChild(item);
            });

            // Add optional games
            const optionalTitle = document.createElement('h4');
            optionalTitle.textContent = 'Optional Tasks:';
            optionalTitle.style.color = '#3498db';
            optionalTitle.style.marginTop = '20px';
            container.appendChild(optionalTitle);
            
            gameState.optionalGames.forEach(game => {
                const item = document.createElement('div');
                item.className = 'game-item';
                item.innerHTML = `üéÆ ${game.title} (+${game.berries} berries)`;
                item.onclick = () => launchGame(game);
                container.appendChild(item);
            });

            list.style.display = list.style.display === 'none' ? 'block' : 'none';
        }

        // Launch Game
        function launchGame(game) {
            // Hide games list
            document.getElementById('gamesList').style.display = 'none';
            
            // Try to use Android interface if available
            if (typeof Android !== 'undefined' && Android.launchGame) {
                Android.launchGame(game.launch);
            } else {
                // Fallback for testing in browser
                alert(`Launching ${game.title}...\n\nIn the app, this will open the game.`);
                // Simulate earning berries after game completion
                setTimeout(() => {
                    addBerries(game.berries);
                }, 2000);
            }
        }

        // Add Berries (called after game completion)
        function addBerries(amount) {
            gameState.berries = Math.min(gameState.berries + amount, gameState.maxBerries);
            saveState();
            updateBerryMeter();
            updateBattleArena();
            updateBattleButton();
        }

        // Battle Boss
        function battleBoss() {
            if (gameState.berries < gameState.maxBerries) {
                alert('You need full berries to battle the boss!');
                return;
            }

            // Animate battle
            const playerCard = document.querySelector('.pokemon-battle-card:first-child');
            const bossCard = document.querySelector('.pokemon-battle-card:last-child');
            
            playerCard.style.animation = 'none';
            setTimeout(() => {
                playerCard.style.animation = 'float 0.5s ease-in-out 3';
            }, 10);

            // Simulate battle
            setTimeout(() => {
                // Player wins if berries are full
                if (gameState.berries >= gameState.maxBerries) {
                    // Unlock new Pokemon
                    if (!gameState.unlockedPokemon.includes(gameState.currentBoss)) {
                        gameState.unlockedPokemon.push(gameState.currentBoss);
                    }
                    
                    // Move to next boss
                    const nextBoss = gameState.currentBoss + 1;
                    if (nextBoss <= pokemonList.length) {
                        gameState.currentBoss = nextBoss;
                    } else {
                        // All Pokemon caught!
                        alert('üéâ Congratulations! You caught all Pokemon! üéâ');
                    }
                    
                    // Reset berries
                    gameState.berries = 0;
                    
                    saveState();
                    renderPokedex();
                    updateBattleArena();
                    updateBerryMeter();
                    updateBattleButton();
                    
                    // Show victory screen
                    showVictory();
                } else {
                    alert('Not enough power! Earn more berries!');
                }
            }, 2000);
        }

        // Show Victory
        function showVictory() {
            const bossPokemon = pokemonList.find(p => p.id === gameState.currentBoss - 1);
            const victorySprite = document.getElementById('victoryPokemonSprite');
            victorySprite.innerHTML = `<img src="${getSpritePath(bossPokemon)}" alt="${bossPokemon.name}" onerror="this.parentElement.textContent='‚ùì';">`;
            document.getElementById('victoryPokemonName').textContent = bossPokemon.name;
            document.getElementById('victoryOverlay').style.display = 'flex';
        }

        // Close Victory
        function closeVictory() {
            document.getElementById('victoryOverlay').style.display = 'none';
        }

        // Event Listeners
        document.getElementById('berryButton').addEventListener('click', showGamesList);
        document.getElementById('battleButton').addEventListener('click', battleBoss);

        // Function to be called from Android after game completion
        window.onGameComplete = function(berriesEarned) {
            addBerries(berriesEarned || 20);
        };

        // Initialize on load
        init();
    </script>
</body>
</html>

